generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id               String       @id @default(uuid())
  email            String       @unique
  password         String
  name             String
  salt             String
  photo            String
  phone            String
  identityDocument String       @unique
  gender           Gender
  userCollege      UserCollege?
}

model UserDocuments {
  id               String       @id @default(uuid())
  docPhotoFrontUrl String
  docPhotoBackUrl  String
  collegeDocUrl    String
  userCollege      UserCollege?
}

model UserValidations {
  id                   String       @id @default(uuid())
  isDocPhotoFrontValid Boolean
  isDocPhotoBackValid  Boolean
  isCollegeDocValid    Boolean
  isEmailVerified      Boolean
  userCollege          UserCollege?
}

model College {
  id           String   @id @default(uuid())
  name         String   @unique
  localization String[]
  courses      Course[]
  events       Event[]
}

model Course {
  id          String        @id @default(uuid())
  name        String
  time        CourseTime
  college     College       @relation(fields: [collegeId], references: [id])
  collegeId   String
  UserCollege UserCollege[]
}

model UserCollege {
  id                String          @id @default(uuid())
  role              UserRoles       @default(NORMAL)
  user              User            @relation(fields: [userId], references: [id])
  documents         UserDocuments   @relation(fields: [userDocumentsId], references: [id])
  validations       UserValidations @relation(fields: [userValidationsId], references: [id])
  course            Course          @relation(fields: [courseId], references: [id])
  userId            String          @unique
  userDocumentsId   String          @unique
  userValidationsId String          @unique
  courseId          String
  ownerEvents       Event[]         @relation(name: "event-owner")
  participantEvents Participant[]
}

model Event {
  id           String        @id @default(uuid())
  owner        UserCollege   @relation(fields: [ownerId], references: [id], name: "event-owner")
  aPoint       College       @relation(fields: [aPointId], references: [id])
  bPoint       String[]
  aPointId     String
  ownerId      String
  status       EventStatus   @default(CREATED)
  createdAt    DateTime      @default(now())
  participants Participant[]
}

model Participant {
  id            String      @id @default(uuid())
  event         Event       @relation(fields: [eventId], references: [id])
  student       UserCollege @relation(fields: [userCollegeId], references: [id])
  createdAt     DateTime    @default(now())
  eventId       String
  userCollegeId String
}

enum Gender {
  MALE
  FEMALE
}

enum CourseTime {
  AM
  PM
}

enum EventStatus {
  CREATED
  WAITING_PARTICIPANTS
  IN_PROGRESS
  FINISHED
}

enum UserRoles {
  NORMAL
  ADMIN
}
